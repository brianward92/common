get_script_dir() {
  # If BASH_SOURCE is not set or empty, use $0 instead
  local source="${BASH_SOURCE[1]:-$0}"
  echo "$(cd "$(dirname "$source")" && pwd)"
}

get_shell_config() {
  CURRENT_SHELL=$(basename "$SHELL")
  if [ "$CURRENT_SHELL" = "zsh" ]; then
    echo "$HOME/.zshrc"
  elif [ "$CURRENT_SHELL" = "bash" ]; then
    echo "$HOME/.bashrc"
  else
    echo "Unsupported shell ($CURRENT_SHELL). Please run this script using either bash or zsh."
    exit 1
  fi
}

add_alias_to_shell_config() {
  local alias_name=$1
  local script_path=$2
  local shell_config=$3
  local line="alias $alias_name=\"$script_path\""

  # Check if the exact alias line exists in the shell config file
  if ! grep -Fxq "$line" "$shell_config"; then
    # If similar alias exists, update it; otherwise, add new
    if grep -Fq "alias $alias_name=" "$shell_config"; then
      sed -i.bak "/alias $alias_name=/d" "$shell_config"
      echo "$line" >> "$shell_config"
      echo "Updated alias $alias_name in $shell_config"
    else
      echo "$line" >> "$shell_config"
      echo "Alias $alias_name has been added to $shell_config"
    fi
  else
    echo "Alias $alias_name already exists in $shell_config"
  fi
}


add_env_var_to_shell_config() {
  local var_name=$1
  local var_value=$2
  local shell_config=$3
  local line="export $var_name=\"$var_value\""

  # Check if the exact env var def line exists in the shell config file
  if ! grep -Fxq "$line" "$shell_config"; then
    # If similar env var def exists, update it; otherwise, add new
    if grep -Fq "export $var_name=" "$shell_config"; then
      sed -i.bak "/export $var_name=/d" "$shell_config"
      echo "$line" >> "$shell_config"
      echo "Updated env var $var_name in $shell_config"
    else
      echo "$line" >> "$shell_config"
      echo "Env var $var_name has been added to $shell_config"
    fi
  else
    echo "Env var $var_name already exists in $shell_config"
  fi
}

handle_error() {
    echo "FAILED"
    exit 1
}
